<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Khóa học | Drug Prevention Support System</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap" rel="stylesheet">
    <style>
        /* ...TOÀN BỘ CSS của bạn giữ nguyên ở đây... */
        :root {
            --primary: #2176ae;
            --secondary: #57b8ff;
            --bg: #f7fbfd;
            --white: #fff;
            --soft: #f0f7fa;
            --shadow: 0 4px 32px 0 rgba(33,118,174,0.09);
        }
        html, body { width: 100%; min-width: 0; overflow-x: hidden !important; box-sizing: border-box;}
        body {
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
            background: var(--bg);
            margin: 0;
            color: #24415d;
            scroll-behavior: smooth;
        }
        .main-wrap { max-width: 1440px; width: 90vw; margin: 0 auto 0 auto; padding: 0 0 40px 0; box-sizing: border-box; display: flex; flex-direction: column; align-items: center;}
        .section { width: 100%; margin: 32px 0 0 0; display: flex; flex-direction: column; align-items: center;}
        .section-title { font-size: 2.2rem; font-weight: 800; color: var(--primary); margin-bottom: 24px; text-align: center; letter-spacing: 0.02em;}
        .courses-filter-bar { background: #fff; box-shadow: 0 2px 12px #2176ae0e; border-radius: 12px; padding: 18px 30px 12px 30px; display: flex; gap: 18px; margin-bottom: 22px; align-items: center; flex-wrap: wrap;}
        .courses-filter-bar select, .courses-filter-bar input[type="text"] { font-family: inherit; border-radius: 7px; border: 1px solid #c7e7fa; font-size: 1em; padding: 6px 14px; background: #f4fbff; color: #274060; outline: none; margin-right: 8px;}
        .courses-filter-bar input[type="text"] { width: 170px;}
        .courses-grid { width: 100%; max-width: 1260px; display: flex; flex-wrap: wrap; justify-content: center; align-items: stretch; gap: 32px; margin: 0 auto 24px auto; padding: 0;}
        .course-card { background: var(--white); border-radius: 14px; box-shadow: var(--shadow); width: 340px; min-width: 220px; max-width: 370px; display: flex; flex-direction: column; align-items: center; transition: box-shadow 0.18s, transform 0.13s; cursor: pointer; overflow: hidden; position: relative;}
        .course-card[hidden] { display: none !important;}
        .course-card:active { transform: scale(0.98);}
        .course-card:focus-within { outline: 2px solid var(--secondary); outline-offset: 2px;}
        .course-card:hover { box-shadow: 0 10px 30px #57b8ff2e; transform: translateY(-4px) scale(1.012);}
        .course-card img { width: 100%; max-height: 168px; object-fit: cover; background: #eaf6fa;}
        .course-card-body { padding: 22px 18px 16px 18px; width: 100%; display: flex; flex-direction: column; align-items: center;}
        .course-title { font-size: 1.22em; font-weight: 700; color: #1c2f49; margin-bottom: 10px; text-align: center;}
        .course-meta { font-size: 0.97em; color: #589cd7; margin-bottom: 7px; text-align: center;}
        .course-desc { font-size: 1em; color: #416084; margin-bottom: 13px; text-align: center;}
        .course-info-row { display: flex; gap: 15px; margin-bottom: 9px; justify-content: center; color: #6fa3ce; font-size: 0.98em;}
        .course-chip { background: linear-gradient(90deg, #e9f7ff 75%, #d2edff 100%); color: #2176ae; border-radius: 7px; font-size: 0.97em; font-weight: 600; padding: 2.5px 10px; margin-right: 4px; display: inline-block; letter-spacing: 0.02em;}
        .course-btn { padding: 9px 18px; border-radius: 8px; border: none; background: linear-gradient(90deg, #2176ae 85%, #57b8ff 100%); color: #fff; font-weight: 700; font-size: 1em; cursor: pointer; transition: background 0.15s, box-shadow 0.13s, transform 0.13s; box-shadow: 0 1px 5px #2176ae18; margin-top: 10px; width: 100%;}
        .course-btn:active { transform: scale(0.97);}
        .course-btn:hover { background: linear-gradient(90deg, #1761b3 65%, #3eaafc 100%); box-shadow: 0 4px 10px #2176ae24; transform: scale(1.02);}
        .course-ribbon { position: absolute; top: 14px; left: -40px; background: linear-gradient(90deg, #57b8ff 80%, #2176ae 100%); color: #fff; font-weight: 600; font-size: 0.93em; padding: 5px 50px 5px 48px; transform: rotate(-22deg); border-radius: 8px 18px 9px 0; box-shadow: 0 3px 8px #57b8ff2a; letter-spacing: 0.04em;}
        @media (max-width: 1150px) { .main-wrap { width: 98vw;} .courses-grid { max-width: 99vw;}}
        @media (max-width: 800px) { .main-wrap { width: 99vw;} .courses-grid { gap: 22px;} .course-card { min-width: 220px; width: 94vw; max-width: 98vw;}}
        @media (max-width: 600px) { .main-wrap { width: 100vw; padding: 0;} .section-title { font-size: 1.4rem;} .courses-grid { gap: 13px;} .course-card { min-width: 160px; width: 99vw;} .courses-filter-bar { padding: 12px 6px 8px 6px; flex-direction: column; gap: 9px;}}
    </style>
</head>
<body>
<div th:replace="member/header :: main-header"></div>
<div class="main-wrap">
    <section class="section">
        <div class="section-title"><i class="fa-solid fa-graduation-cap"></i> Danh sách Khóa học</div>
        <div class="courses-filter-bar">
            <select id="filterTarget">
                <option value="">Tất cả đối tượng</option>
                <option value="Học sinh">Học sinh</option>
                <option value="Sinh viên">Sinh viên</option>
                <option value="Phụ huynh">Phụ huynh</option>
                <option value="Giáo viên">Giáo viên</option>
            </select>
            <input id="searchInput" type="text" placeholder="Tìm kiếm khóa học...">
        </div>
    </section>
    <section class="section">
        <div class="courses-grid" id="coursesGrid">
            <div class="course-card"
                 th:each="course : ${courses}"
                 th:attr="data-target=${course.targetObject}, data-title=${course.name}, data-desc=${course.description}">
                <span class="course-ribbon" th:if="${course.topic == 'Nhận thức về ma túy'}">Phổ biến</span>
                <img th:src="${course.image != null && !#strings.isEmpty(course.image) ? course.image : 'https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=600&q=80'}"
                     class="card-img" th:alt="${course.name}" />
                <div class="course-card-body">
                    <div class="course-title" th:text="${course.name}"></div>
                    <div class="course-meta">
                        Đối tượng:
                        <span class="course-chip" th:text="${course.targetObject}"></span>
                        <span th:if="${course.participants != null}">
                            | <span th:text="${course.participants}"></span> người tham gia
                        </span>
                    </div>
                    <div class="course-desc" th:text="${course.description}"></div>
                    <div class="course-info-row">
                        <span th:text="${course.topic}"></span>
                    </div>
                    <button class="course-btn">Vào học</button>
                </div>
            </div>
        </div>
        <div id="noCourseMsg" style="display:none;color:#57b8ff;font-weight:500;font-size:1.1em;text-align:center;padding:26px;">
            Không tìm thấy khóa học nào phù hợp.
        </div>
    </section>
</div>
<div th:replace="member/footer :: main-footer"></div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const filterTarget = document.getElementById('filterTarget');
    const searchInput = document.getElementById('searchInput');
    const coursesGrid = document.getElementById('coursesGrid');
    const noCourseMsg = document.getElementById('noCourseMsg');

    function doFilter() {
        const target = filterTarget.value.trim().toLowerCase();
        const keyword = searchInput.value.trim().toLowerCase();
        let visibleCount = 0;
        coursesGrid.querySelectorAll('.course-card').forEach(card => {
            const cardTarget = (card.getAttribute('data-target') || '').toLowerCase();
            const cardTitle = (card.getAttribute('data-title') || '').toLowerCase();
            const cardDesc = (card.getAttribute('data-desc') || '').toLowerCase();

            let matchTarget = !target || cardTarget === target;
            let matchKeyword = !keyword
                || cardTitle.includes(keyword)
                || cardDesc.includes(keyword);

            if (matchTarget && matchKeyword) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });
        noCourseMsg.style.display = visibleCount === 0 ? '' : 'none';
    }

    filterTarget.addEventListener('change', doFilter);
    searchInput.addEventListener('input', doFilter);
});
</script>
</body>
</html>
