<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tin tức & Blog | Drug Prevention Support System</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Font Awesome & Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .news-main-wrap {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .news-content {
            flex: 3;
            margin-right: 20px;
        }
        .news-sidebar {
            flex: 1;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
        }
        .news-categories, .sidebar-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .news-category, .sidebar-tag {
            padding: 10px 15px;
            background-color: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
        }
        .news-category.active, .sidebar-tag.active {
            background-color: #007bff;
            color: #fff;
        }
        .featured-news, .news-list-card {
            display: flex;
            background-color: #fff;
            border-radius: 8px;
            margin-bottom: 20px;
            cursor: pointer;
        }
        .featured-news-img, .news-list-img {
            width: 150px;
            height: auto;
            border-radius: 8px 0 0 8px;
        }
        .featured-news-body, .news-list-body {
            padding: 15px;
        }
        .featured-news-type, .news-list-title {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div th:replace="member/header :: main-header"></div>
    <div class="news-main-wrap">
        <div class="news-content">
            <!-- Mục lục thể loại -->
            <div class="news-categories">
                <button th:classappend="${currentCat == null} ? 'active'" 
                        class="news-category" 
                        onclick="window.location.href='/blog'">Tất cả</button>
                <button th:each="cat : ${categories}"
                        th:classappend="${currentCat == cat} ? 'active'"
                        class="news-category" 
                        th:onclick="'window.location.href=\'/blog?category=' + ${cat} + '\''"
                        th:text="${cat}"></button>
            </div>
            
            <!-- Tin nổi bật nhất -->
            <div th:if="${not #lists.isEmpty(posts)}">
                <div class="featured-news" 
                     th:onclick="'window.location.href=\'/blog/' + ${posts[0].id} + '\''" 
                     tabindex="0">
                    <img class="featured-news-img" th:src="${posts[0].imageUrl}" th:alt="${posts[0].title}">
                    <div class="featured-news-body">
                        <div class="featured-news-type" th:text="${posts[0].category}"></div>
                        <div class="featured-news-title" th:text="${posts[0].title}"></div>
                        <div class="featured-news-summary" th:text="${posts[0].summary}"></div>
                        <div class="featured-news-meta">
                            <i class="fa fa-user"></i> <span th:text="${posts[0].author}"></span> &nbsp; 
                            <i class="fa fa-calendar"></i> <span th:text="${#dates.format(posts[0].createdAt, 'dd/MM/yyyy')}"></span>
                        </div>
                        <div class="featured-news-link">Đọc chi tiết <i class="fa fa-arrow-right"></i></div>
                    </div>
                </div>
            </div>
            
            <!-- Danh sách các tin khác -->
            <div class="news-list">
                <div th:each="post,iter : ${posts}" 
                     th:if="${iter.index > 0}"
                     class="news-list-card" 
                     th:onclick="'window.location.href=\'/blog/' + ${post.id} + '\''" 
                     tabindex="0">
                    <img class="news-list-img" th:src="${post.imageUrl}" th:alt="${post.title}">
                    <div class="news-list-body">
                        <div class="news-list-title" th:text="${post.title}"></div>
                        <div class="news-list-summary" th:text="${post.summary}"></div>
                        <div class="news-list-meta">
                            <i class="fa fa-user"></i> <span th:text="${post.author}"></span> &nbsp; 
                            <i class="fa fa-calendar"></i> <span th:text="${#dates.format(post.createdAt, 'dd/MM/yyyy')}"></span>
                        </div>
                    </div>
                </div>
                <div th:if="${#lists.isEmpty(posts)}" 
                     style="padding:34px 0 50px 0;color:#888;text-align:center;font-size:1.16em;">
                    Không tìm thấy bài viết nào.
                </div>
            </div>
        </div>
        
        <!-- Sidebar -->
        <div class="news-sidebar">
            <div class="sidebar-block">
                <div class="sidebar-title"><i class="fa fa-search"></i> Tìm kiếm bài viết</div>
                <form action="/blog" method="get">
                    <input type="text" class="sidebar-search" name="search" placeholder="Từ khóa..." th:value="${currentSearch}">
                    <input type="hidden" name="category" th:value="${currentCat}">
                    <input type="hidden" name="tag" th:value="${currentTag}">
                </form>
            </div>
            <div class="sidebar-block">
                <div class="sidebar-title"><i class="fa fa-tags"></i> Tag nổi bật</div>
                <div class="sidebar-tags">
                    <div th:classappend="${currentTag == null} ? 'active'" 
                         class="sidebar-tag" 
                         onclick="window.location.href='/blog'">Tất cả</div>
                    <div th:each="tag : ${tags}"
                         th:classappend="${currentTag == tag} ? 'active'"
                         class="sidebar-tag" 
                         th:onclick="'window.location.href=\'/blog?tag=' + ${tag} + '\''"
                         th:text="${tag}"></div>
                </div>
            </div>
            <div class="sidebar-block">
                <div class="sidebar-title"><i class="fa fa-handshake"></i> Nhà tài trợ tiêu biểu</div>
                <div class="sponsor-list">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Unicef_logo.svg" class="sponsor-logo" alt="UNICEF">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/World_Health_Organization_Logo.svg" class="sponsor-logo" alt="WHO">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg" class="sponsor-logo" alt="Microsoft">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/a/ae/Red_Cross_logo.svg" class="sponsor-logo" alt="Red Cross">
                </div>
            </div>
        </div>
    </div>
    <div th:replace="member/footer :: main-footer"></div>
</body>
</html>