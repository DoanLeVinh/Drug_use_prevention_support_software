<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Quản lý Khóa học | Hệ thống Phòng ngừa Ma túy</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #dfe6e9;
        }
        
        body {
            background: var(--bg-color);
            font-family: 'Inter', sans-serif;
            margin: 0;
            color: var(--text-color);
        }
        
        /* Layout chung */
        .main-admin-content {
            max-width: 1800px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-title {
            color: var(--primary-color);
            font-size: 1.8rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* Thanh công cụ - Đã tối ưu khoảng cách */
        .toolbar {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 25px;
            align-items: center;
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .search-container {
            flex: 1;
            min-width: 250px;
            max-width: 400px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 0.95rem;
            background: var(--card-bg);
            transition: all 0.2s;
        }
        
        .search-input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            outline: none;
        }
        
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--secondary-color);
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 0.95rem;
            background: var(--card-bg);
            color: var(--text-color);
            cursor: pointer;
            min-width: 180px;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
        }
        
        .btn-primary {
            background: var(--success-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #219653;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--secondary-color);
            color: var(--secondary-color);
        }
        
        .btn-outline:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        /* Bảng dữ liệu */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        .table-responsive {
            overflow-x: auto;
            border-radius: 10px;
        }
        
        .course-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .course-table th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.03em;
            text-align: left;
            padding: 14px 16px;
            white-space: nowrap;
        }
        
        .course-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        
        .course-table tr:last-child td {
            border-bottom: none;
        }
        
        .course-table tr:hover {
            background: rgba(52, 152, 219, 0.03);
        }
        
        /* Trạng thái */
        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: #e8f7ef;
            color: var(--success-color);
        }
        
        .badge-warning {
            background: #fffbe5;
            color: var(--warning-color);
        }
        
        .badge-danger {
            background: #fdecea;
            color: var(--danger-color);
        }
        
        /* Nút hành động */
        .action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            color: var(--secondary-color);
            background: rgba(52, 152, 219, 0.1);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 3px;
        }
        
        .action-btn:hover {
            background: var(--secondary-color);
            color: white;
        }
        
        .action-btn.edit {
            color: var(--warning-color);
            background: rgba(243, 156, 18, 0.1);
        }
        
        .action-btn.edit:hover {
            background: var(--warning-color);
            color: white;
        }
        
        .action-btn.delete {
            color: var(--danger-color);
            background: rgba(231, 76, 60, 0.1);
        }
        
        .action-btn.delete:hover {
            background: var(--danger-color);
            color: white;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(3px);
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.2s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            padding: 18px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-color);
            color: white;
        }
        
        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-body {
            padding: 20px 24px;
            overflow-y: auto;
            flex-grow: 1;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: white;
        }
        
        /* Form thêm khóa học - Đã tối ưu */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group.full-width {
            grid-column: span 2;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--dark-color);
        }
        
        .form-control {
            width: 100%;
            padding: 10px 14px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 0.95rem;
            transition: all 0.2s;
            background: var(--card-bg);
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            outline: none;
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            background: var(--light-color);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .form-upload:hover {
            border-color: var(--secondary-color);
            background: rgba(52, 152, 219, 0.05);
        }
        
        .form-upload i {
            font-size: 2rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-group.full-width {
                grid-column: span 1;
            }
        }
        
        @media (max-width: 768px) {
            .main-admin-content {
                padding: 20px 15px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            .filter-group {
                width: 100%;
            }
            
            .filter-select {
                width: 100%;
            }
            
            .modal-content {
                width: 95%;
            }
        }
        
        /* Course card in table */
        .course-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .course-thumbnail {
            width: 60px;
            height: 40px;
            border-radius: 6px;
            object-fit: cover;
            background: #f0f7fc;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary-color);
        }
        
        .course-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .course-category {
            font-size: 0.85rem;
            color: #666;
        }
        
        /* Age group tags */
        .age-tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 5px;
            background: #e0f7fa;
            color: #00838f;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-color);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            color: var(--secondary-color);
            border-bottom-color: var(--secondary-color);
        }
        
        .tab:hover:not(.active) {
            color: var(--secondary-color);
            background: rgba(52, 152, 219, 0.05);
        }
    </style>
</head>
<body>
<!-- Kế thừa header từ admin/header.html -->
<div th:replace="admin/header :: main-header"></div>

<div class="main-admin-content">
    <div class="section-header">
        <h1 class="section-title">
            <i class="fas fa-graduation-cap"></i>
            Quản lý Khóa học Phòng ngừa Ma túy
        </h1>
        <button class="btn btn-primary" id="addCourseBtn">
            <i class="fas fa-plus"></i>
            Thêm khóa học mới
        </button>
    </div>
    
    <div class="toolbar">
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="courseSearch" placeholder="Tìm kiếm khóa học...">
        </div>
        
        <div class="filter-group">
            <select class="filter-select" id="statusFilter">
                <option value="all">Tất cả trạng thái</option>
                <option value="active">Đang hoạt động</option>
                <option value="draft">Bản nháp</option>
                <option value="archived">Đã lưu trữ</option>
            </select>
            
            <select class="filter-select" id="categoryFilter">
                <option value="all">Tất cả danh mục</option>
                <option value="awareness">Nhận thức ma túy</option>
                <option value="prevention">Kỹ năng phòng tránh</option>
                <option value="refusal">Kỹ năng từ chối</option>
                <option value="recovery">Phục hồi sau cai nghiện</option>
            </select>
            
            <select class="filter-select" id="ageGroupFilter">
                <option value="all">Tất cả độ tuổi</option>
                <option value="student">Học sinh</option>
                <option value="college">Sinh viên</option>
                <option value="parent">Phụ huynh</option>
                <option value="teacher">Giáo viên</option>
            </select>
        </div>
    </div>
    
    <div class="card">
        <div class="table-responsive">
            <table class="course-table" id="courseTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tên khóa học</th>
                        <th>Danh mục</th>
                        <th>Độ tuổi</th>
                        <th>Giảng viên</th>
                        <th>Học viên</th>
                        <th>Trạng thái</th>
                        <th>Ngày tạo</th>
                        <th>Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>DRG001</td>
                        <td>
                            <div class="course-info">
                                <div class="course-thumbnail">
                                    <i class="fas fa-pills"></i>
                                </div>
                                <div>
                                    <div class="course-title">Nhận biết các loại ma túy phổ biến</div>
                                    <div class="course-category">Nhận thức ma túy</div>
                                </div>
                            </div>
                        </td>
                        <td>Nhận thức ma túy</td>
                        <td>
                            <span class="age-tag">Học sinh</span>
                            <span class="age-tag">Sinh viên</span>
                        </td>
                        <td>BS. Nguyễn Văn A</td>
                        <td>128</td>
                        <td><span class="badge badge-success">Đang hoạt động</span></td>
                        <td>15/03/2024</td>
                        <td>
                            <button class="action-btn" title="Xem chi tiết" onclick="viewCourseDetail('DRG001')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit" title="Chỉnh sửa" onclick="editCourse('DRG001')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" title="Xóa" onclick="deleteCourse('DRG001')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>DRG002</td>
                        <td>
                            <div class="course-info">
                                <div class="course-thumbnail">
                                    <i class="fas fa-hand-paper"></i>
                                </div>
                                <div>
                                    <div class="course-title">Kỹ năng từ chối ma túy</div>
                                    <div class="course-category">Kỹ năng từ chối</div>
                                </div>
                            </div>
                        </td>
                        <td>Kỹ năng từ chối</td>
                        <td>
                            <span class="age-tag">Học sinh</span>
                            <span class="age-tag">Sinh viên</span>
                        </td>
                        <td>TS. Trần Thị B</td>
                        <td>89</td>
                        <td><span class="badge badge-success">Đang hoạt động</span></td>
                        <td>22/02/2024</td>
                        <td>
                            <button class="action-btn" title="Xem chi tiết" onclick="viewCourseDetail('DRG002')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit" title="Chỉnh sửa" onclick="editCourse('DRG002')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" title="Xóa" onclick="deleteCourse('DRG002')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>DRG003</td>
                        <td>
                            <div class="course-info">
                                <div class="course-thumbnail">
                                    <i class="fas fa-user-shield"></i>
                                </div>
                                <div>
                                    <div class="course-title">Phòng tránh ma túy trong trường học</div>
                                    <div class="course-category">Kỹ năng phòng tránh</div>
                                </div>
                            </div>
                        </td>
                        <td>Kỹ năng phòng tránh</td>
                        <td>
                            <span class="age-tag">Giáo viên</span>
                            <span class="age-tag">Phụ huynh</span>
                        </td>
                        <td>PGS. Lê Văn C</td>
                        <td>215</td>
                        <td><span class="badge badge-success">Đang hoạt động</span></td>
                        <td>10/01/2024</td>
                        <td>
                            <button class="action-btn" title="Xem chi tiết" onclick="viewCourseDetail('DRG003')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit" title="Chỉnh sửa" onclick="editCourse('DRG003')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" title="Xóa" onclick="deleteCourse('DRG003')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>DRG004</td>
                        <td>
                            <div class="course-info">
                                <div class="course-thumbnail">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div>
                                    <div class="course-title">Nhận biết dấu hiệu con nghiện ma túy</div>
                                    <div class="course-category">Nhận thức ma túy</div>
                                </div>
                            </div>
                        </td>
                        <td>Nhận thức ma túy</td>
                        <td>
                            <span class="age-tag">Phụ huynh</span>
                        </td>
                        <td>ThS. Phạm Thị D</td>
                        <td>42</td>
                        <td><span class="badge badge-warning">Bản nháp</span></td>
                        <td>05/04/2024</td>
                        <td>
                            <button class="action-btn" title="Xem chi tiết" onclick="viewCourseDetail('DRG004')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit" title="Chỉnh sửa" onclick="editCourse('DRG004')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" title="Xóa" onclick="deleteCourse('DRG004')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Phân trang -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
        <div style="color: #666; font-size: 0.9rem;">
            Hiển thị 1-4 của 4 khóa học
        </div>
        <div style="display: flex; gap: 8px;">
            <button class="btn btn-outline" style="padding: 8px 12px;" disabled>
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="btn btn-outline" style="padding: 8px 12px; background: var(--secondary-color); color: white;">
                1
            </button>
            <button class="btn btn-outline" style="padding: 8px 12px;" disabled>
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
</div>

<!-- Modal Xem chi tiết khóa học -->
<div class="modal" id="viewCourseModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-info-circle"></i>
                Chi tiết khóa học
            </h3>
            <button class="close-btn" onclick="closeModal('viewCourseModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body" id="courseDetailContent">
            <!-- Nội dung sẽ được điền bằng JavaScript -->
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('viewCourseModal')">
                Đóng
            </button>
        </div>
    </div>
</div>

<!-- Modal Thêm/Chỉnh sửa khóa học - Đã tối ưu -->
<div class="modal" id="editCourseModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="editModalTitle">
                <i class="fas fa-plus-circle"></i>
                Thêm khóa học mới
            </h3>
            <button class="close-btn" onclick="closeModal('editCourseModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('general')">Thông tin chung</div>
                <div class="tab" onclick="switchTab('content')">Nội dung</div>
                <div class="tab" onclick="switchTab('settings')">Cài đặt</div>
            </div>
            
            <form id="courseForm">
                <div id="generalTab" class="tab-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Tên khóa học*</label>
                            <input type="text" class="form-control" id="courseName" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mã khóa học</label>
                            <input type="text" class="form-control" id="courseCode">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Danh mục*</label>
                            <select class="form-control" id="courseCategory" required>
                                <option value="">Chọn danh mục</option>
                                <option value="awareness">Nhận thức ma túy</option>
                                <option value="prevention">Kỹ năng phòng tránh</option>
                                <option value="refusal">Kỹ năng từ chối</option>
                                <option value="recovery">Phục hồi sau cai nghiện</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Giảng viên*</label>
                            <select class="form-control" id="courseInstructor" required>
                                <option value="">Chọn giảng viên</option>
                                <option value="BS. Nguyễn Văn A">BS. Nguyễn Văn A</option>
                                <option value="TS. Trần Thị B">TS. Trần Thị B</option>
                                <option value="PGS. Lê Văn C">PGS. Lê Văn C</option>
                                <option value="ThS. Phạm Thị D">ThS. Phạm Thị D</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">Mô tả ngắn*</label>
                            <textarea class="form-control" id="courseShortDesc" required rows="3"></textarea>
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">Đối tượng học viên*</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="ageGroup" value="student"> Học sinh
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="ageGroup" value="college"> Sinh viên
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="ageGroup" value="parent"> Phụ huynh
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" name="ageGroup" value="teacher"> Giáo viên
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">Hình ảnh đại diện</label>
                            <div class="form-upload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Kéo thả hình ảnh vào đây hoặc click để chọn</span>
                                <input type="file" id="courseImage" style="display: none;">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="contentTab" class="tab-content" style="display: none;">
                    <div class="form-group full-width">
                        <label class="form-label">Mô tả chi tiết*</label>
                        <textarea class="form-control" id="courseDescription" required rows="8"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Thời lượng (giờ)*</label>
                        <input type="number" class="form-control" id="courseDuration" required min="1">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Số bài học*</label>
                        <input type="number" class="form-control" id="courseLessons" required min="1">
                    </div>
                </div>
                
                <div id="settingsTab" class="tab-content" style="display: none;">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Giá (VND)*</label>
                            <input type="number" class="form-control" id="coursePrice" required min="0">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Trạng thái*</label>
                            <select class="form-control" id="courseStatus" required>
                                <option value="active">Đang hoạt động</option>
                                <option value="draft">Bản nháp</option>
                                <option value="archived">Lưu trữ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Ngày bắt đầu</label>
                            <input type="date" class="form-control" id="courseStartDate">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Ngày kết thúc</label>
                            <input type="date" class="form-control" id="courseEndDate">
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">Yêu cầu đầu vào</label>
                            <textarea class="form-control" id="courseRequirements" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('editCourseModal')">
                Hủy
            </button>
            <button class="btn btn-primary" id="saveCourseBtn">
                Lưu thay đổi
            </button>
        </div>
    </div>
</div>

<!-- Modal Xác nhận xóa -->
<div class="modal" id="deleteConfirmModal">
    <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-exclamation-triangle"></i>
                Xác nhận xóa
            </h3>
            <button class="close-btn" onclick="closeModal('deleteConfirmModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <p>Bạn có chắc chắn muốn xóa khóa học này? Hành động này không thể hoàn tác.</p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('deleteConfirmModal')">
                Hủy
            </button>
            <button class="btn btn-primary" id="confirmDeleteBtn" style="background: var(--danger-color);">
                Xác nhận xóa
            </button>
        </div>
    </div>
</div>

<script>
    // Mở modal xem chi tiết
    function viewCourseDetail(courseId) {
        // Giả lập dữ liệu - trong thực tế sẽ gọi API
        const courses = {
            'DRG001': {
                title: 'Nhận biết các loại ma túy phổ biến',
                category: 'Nhận thức ma túy',
                instructor: 'BS. Nguyễn Văn A',
                ageGroups: ['Học sinh', 'Sinh viên'],
                students: 128,
                price: 'Miễn phí',
                status: 'Đang hoạt động',
                created: '15/03/2024',
                description: 'Khóa học cung cấp kiến thức cơ bản về các loại ma túy phổ biến hiện nay, cách nhận biết và tác hại của chúng. Đặc biệt tập trung vào các loại ma túy thường nhắm đến đối tượng học sinh, sinh viên.',
                duration: '2 giờ',
                lessons: '6 bài học',
                requirements: 'Không yêu cầu kiến thức trước'
            },
            'DRG002': {
                title: 'Kỹ năng từ chối ma túy',
                category: 'Kỹ năng từ chối',
                instructor: 'TS. Trần Thị B',
                ageGroups: ['Học sinh', 'Sinh viên'],
                students: 89,
                price: 'Miễn phí',
                status: 'Đang hoạt động',
                created: '22/02/2024',
                description: 'Khóa học trang bị các kỹ năng cần thiết để từ chối ma túy trong các tình huống xã hội, giúp học viên tự tin nói "không" với các chất gây nghiện.',
                duration: '3 giờ',
                lessons: '8 bài học',
                requirements: 'Không yêu cầu kiến thức trước'
            }
        };
        
        const course = courses[courseId] || {
            title: 'Khóa học không xác định',
            description: 'Không có thông tin chi tiết'
        };
        
        const html = `
            <div style="margin-bottom: 20px;">
                <h3 style="color: var(--primary-color); margin-bottom: 10px;">${course.title}</h3>
                <div style="display: flex; gap: 20px; margin-bottom: 15px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 250px;">
                        <p><strong>Danh mục:</strong> ${course.category}</p>
                        <p><strong>Giảng viên:</strong> ${course.instructor}</p>
                        <p><strong>Đối tượng:</strong> ${course.ageGroups?.join(', ') || 'Không xác định'}</p>
                    </div>
                    <div style="flex: 1; min-width: 250px;">
                        <p><strong>Học viên:</strong> ${course.students || 0}</p>
                        <p><strong>Trạng thái:</strong> ${course.status}</p>
                        <p><strong>Ngày tạo:</strong> ${course.created}</p>
                    </div>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 8px;">Mô tả khóa học</h4>
                    <p>${course.description}</p>
                </div>
                
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 250px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 8px;">Thông tin khóa học</h4>
                        <p><strong>Thời lượng:</strong> ${course.duration || 'Không xác định'}</p>
                        <p><strong>Số bài học:</strong> ${course.lessons || 'Không xác định'}</p>
                        <p><strong>Yêu cầu:</strong> ${course.requirements || 'Không có'}</p>
                    </div>
                    <div style="flex: 1; min-width: 250px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 8px;">Thống kê</h4>
                        <p><strong>Đánh giá trung bình:</strong> 4.7/5 (${Math.floor(course.students * 0.7)} đánh giá)</p>
                        <p><strong>Tỉ lệ hoàn thành:</strong> ${Math.floor(Math.random() * 30) + 70}%</p>
                        <p><strong>Phản hồi tích cực:</strong> ${Math.floor(Math.random() * 20) + 80}%</p>
                    </div>
                </div>
            </div>
        `;
        
        document.getElementById('courseDetailContent').innerHTML = html;
        document.getElementById('viewCourseModal').classList.add('active');
    }
    
    // Mở modal thêm/chỉnh sửa
    function editCourse(courseId) {
        const title = courseId ? 'Chỉnh sửa khóa học' : 'Thêm khóa học mới';
        document.getElementById('editModalTitle').innerHTML = `<i class="fas fa-edit"></i> ${title}`;
        
        // Reset tabs
        switchTab('general');
        
        if (courseId) {
            // Giả lập dữ liệu - trong thực tế sẽ gọi API
            const courses = {
                'DRG001': {
                    name: 'Nhận biết các loại ma túy phổ biến',
                    code: 'DRG001',
                    category: 'awareness',
                    instructor: 'BS. Nguyễn Văn A',
                    ageGroups: ['student', 'college'],
                    shortDesc: 'Khóa học cung cấp kiến thức cơ bản về các loại ma túy phổ biến hiện nay',
                    description: 'Khóa học cung cấp kiến thức cơ bản về các loại ma túy phổ biến hiện nay, cách nhận biết và tác hại của chúng...',
                    duration: 2,
                    lessons: 6,
                    price: 0,
                    status: 'active',
                    requirements: 'Không yêu cầu kiến thức trước'
                }
            };
            
            const course = courses[courseId] || {};
            
            // Điền dữ liệu vào form
            document.getElementById('courseName').value = course.name || '';
            document.getElementById('courseCode').value = course.code || '';
            document.getElementById('courseCategory').value = course.category || '';
            document.getElementById('courseInstructor').value = course.instructor || '';
            document.getElementById('courseShortDesc').value = course.shortDesc || '';
            document.getElementById('courseDescription').value = course.description || '';
            document.getElementById('courseDuration').value = course.duration || '';
            document.getElementById('courseLessons').value = course.lessons || '';
            document.getElementById('coursePrice').value = course.price || '';
            document.getElementById('courseStatus').value = course.status || 'active';
            document.getElementById('courseRequirements').value = course.requirements || '';
            
            // Điền checkbox độ tuổi
            if (course.ageGroups) {
                document.querySelectorAll('input[name="ageGroup"]').forEach(checkbox => {
                    checkbox.checked = course.ageGroups.includes(checkbox.value);
                });
            }
        } else {
            // Reset form khi thêm mới
            document.getElementById('courseForm').reset();
        }
        
        document.getElementById('editCourseModal').classList.add('active');
    }
    
    // Chuyển tab trong form
    function switchTab(tabId) {
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.querySelectorAll('.tab-content').forEach(content => {
            content.style.display = 'none';
        });
        
        document.querySelector(`.tab:nth-child(${tabId === 'general' ? 1 : tabId === 'content' ? 2 : 3})`).classList.add('active');
        document.getElementById(`${tabId}Tab`).style.display = 'block';
    }
    
    // Mở modal xác nhận xóa
    function deleteCourse(courseId) {
        // Lưu ID khóa học cần xóa vào nút xác nhận
        document.getElementById('confirmDeleteBtn').dataset.courseId = courseId;
        document.getElementById('deleteConfirmModal').classList.add('active');
    }
    
    // Đóng modal
    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
    }
    
    // Xử lý sự kiện khi nhấn nút thêm khóa học
    document.getElementById('addCourseBtn').addEventListener('click', function() {
        editCourse(null);
    });
    
    // Xử lý sự kiện khi nhấn nút lưu
    document.getElementById('saveCourseBtn').addEventListener('click', function() {
        alert('Đã lưu thông tin khóa học (demo)');
        closeModal('editCourseModal');
    });
    
    // Xử lý sự kiện khi nhấn nút xác nhận xóa
    document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
        const courseId = this.dataset.courseId;
        alert(`Đã xóa khóa học ${courseId} (demo)`);
        closeModal('deleteConfirmModal');
    });
    
    // Tìm kiếm khóa học
    document.getElementById('courseSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('#courseTable tbody tr');
        
        rows.forEach(row => {
            const title = row.querySelector('.course-title').textContent.toLowerCase();
            const category = row.querySelector('.course-category').textContent.toLowerCase();
            const instructor = row.cells[4].textContent.toLowerCase();
            
            if (title.includes(searchTerm) || category.includes(searchTerm) || instructor.includes(searchTerm)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
    
    // Lọc theo trạng thái
    document.getElementById('statusFilter').addEventListener('change', function(e) {
        const status = e.target.value;
        const rows = document.querySelectorAll('#courseTable tbody tr');
        
        rows.forEach(row => {
            const badge = row.querySelector('.badge').textContent.toLowerCase();
            
            if (status === 'all' || 
                (status === 'active' && badge === 'đang hoạt động') ||
                (status === 'draft' && badge === 'bản nháp') ||
                (status === 'archived' && badge === 'đã lưu trữ')) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
    
    // Lọc theo danh mục
    document.getElementById('categoryFilter').addEventListener('change', function(e) {
        const category = e.target.value;
        const rows = document.querySelectorAll('#courseTable tbody tr');
        
        rows.forEach(row => {
            const rowCategory = row.cells[2].textContent.toLowerCase();
            
            if (category === 'all' || 
                (category === 'awareness' && rowCategory.includes('nhận thức')) ||
                (category === 'prevention' && rowCategory.includes('phòng tránh')) ||
                (category === 'refusal' && rowCategory.includes('từ chối')) ||
                (category === 'recovery' && rowCategory.includes('phục hồi'))) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
    
    // Lọc theo độ tuổi
    document.getElementById('ageGroupFilter').addEventListener('change', function(e) {
        const ageGroup = e.target.value;
        const rows = document.querySelectorAll('#courseTable tbody tr');
        
        rows.forEach(row => {
            const ageTags = row.cells[3].textContent.toLowerCase();
            
            if (ageGroup === 'all' || 
                (ageGroup === 'student' && ageTags.includes('học sinh')) ||
                (ageGroup === 'college' && ageTags.includes('sinh viên')) ||
                (ageGroup === 'parent' && ageTags.includes('phụ huynh')) ||
                (ageGroup === 'teacher' && ageTags.includes('giáo viên'))) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
    
    // Upload hình ảnh
    document.querySelector('.form-upload').addEventListener('click', function() {
        document.getElementById('courseImage').click();
    });
    
    document.getElementById('courseImage').addEventListener('change', function(e) {
        if (e.target.files.length > 0) {
            const fileName = e.target.files[0].name;
            document.querySelector('.form-upload span').textContent = fileName;
        }
    });
</script>
</body>
</html>